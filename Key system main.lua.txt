-- Config Section
Config = {
    api = "267cefc7-580e-4b3b-bf65-6b3e7d9784ed",
    service = "ZumHub",
    provider = "ZumHub",
    discordInvite = "kv5wr2Naj", -- Change this to update the Discord invite link
    title = "ZumHub Key System", -- Change this to update the GUI title
    keyFileName = "Zumhubkey.txt", -- Change this to update the saved key filename
    scriptUrl = "https://raw.githubusercontent.com/UwURaww/-ZumHub-Script-/refs/heads/main/Protected_6601639189420021.lua", -- Change this to update the script to execute
    intro = {
        enabled = true, -- Set to false to disable the intro
        text = "Welcome to ZumHub", -- Change this to customize the intro text
        duration = 2, -- Duration of the intro animation in seconds
        textColor = Color3.fromRGB(0, 255, 200), -- Color of the intro text
        backgroundColor = Color3.fromRGB(10, 10, 25), -- Background color of the intro
        soundId = "rbxassetid://6655851046", -- Sound to play during intro (change to custom sound ID)
        font = Enum.Font.SciFi, -- Font for the intro text (e.g., Enum.Font.SciFi, Enum.Font.SourceSans, etc.)
        textSize = 24, -- Size of the intro text
        iconId = "rbxassetid://0", -- Icon asset ID for the intro (change to a valid Roblox image asset ID, e.g., "rbxassetid://1234567890")
        iconSize = UDim2.new(0, 100, 0, 100), -- Size of the icon (width, height in pixels)
        enableBlur = true -- Set to true to enable blur effect on background, false to disable
    }
}
-- End Config Section

-- Main Section (Converted to loadstring)
local main = loadstring([[
    local success, err = pcall(function()
        loadstring(game:HttpGet("]] .. Config.scriptUrl .. [[", true))()
        print("script loaded uerd was here")
    end)
    if not success then
        warn("Internal script failed to load: " .. tostring(err))
    end
]])
-- End Main Section

if getgenv().RedExecutorKeySys then return end
getgenv().RedExecutorKeySys = true

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")
local HttpService = game:GetService("HttpService")
local SoundService = game:GetService("SoundService")

local KeySystemData = {
    Name = Config.title,
    Colors = {
        Background = Color3.fromRGB(10, 10, 25),
        BackgroundGradientFrom = Color3.fromRGB(10, 10, 30),
        BackgroundGradientTo = Color3.fromRGB(5, 5, 15),
        Title = Color3.fromRGB(0, 255, 200),
        InputField = Color3.fromRGB(20, 20, 40),
        InputFieldBorder = Color3.fromRGB(0, 200, 255),
        Button = Color3.fromRGB(30, 30, 50),
        ButtonHover = Color3.fromRGB(50, 50, 80),
        Error = Color3.fromRGB(255, 80, 80),
        Success = Color3.fromRGB(80, 255, 100),
        Discord = Color3.fromRGB(160, 80, 255)
    },
    Service = "redexecutor",
    SilentMode = false,
    DiscordInvite = Config.discordInvite,
    WebsiteURL = "https://yourwebsite.com/",
    FileName = Config.keyFileName
}

local SoundAssets = {
    UIOpen = {Id = "rbxassetid://6655851046"},
    ButtonClick = {Id = "rbxassetid://6655851046"},
    Success = {Id = "rbxassetid://6655851046"},
    SuccessDiscord = {Id = "rbxassetid://6655851046"},
    Error = {Id = "rbxassetid://6655851046"},
    AccessDenied = {Id = "rbxassetid://6655851046"}
}

local function PlaySound(soundData)
    local success, err = pcall(function()
        local sound = Instance.new("Sound")
        sound.SoundId = soundData.Id
        sound.Volume = 1.0
        sound.Parent = game.Workspace
        sound:Play()
        game.Debris:AddItem(sound, 3)
    end)
    if not success then
        warn("Failed to play sound " .. soundData.Id .. ": " .. tostring(err))
    end
end

local function CreateObject(class, props)
    local obj = Instance.new(class)
    for prop, value in pairs(props) do
        if prop ~= "Parent" then obj[prop] = value end
    end
    if props.Parent then obj.Parent = props.Parent end
    return obj
end

local function SmoothTween(obj, time, properties, easingStyle, easingDirection)
    local success, tween = pcall(function()
        return TweenService:Create(obj, TweenInfo.new(time, easingStyle or Enum.EasingStyle.Quad, easingDirection or Enum.EasingDirection.Out), properties)
    end)
    if success then tween:Play() else warn("Tween failed for " .. obj.Name) end
    return tween
end

-- Intro GUI
local function ShowIntro()
    if not Config.intro.enabled then return end

    local IntroGui = CreateObject("ScreenGui", {
        Name = "ZumHubIntro",
        Parent = CoreGui,
        ResetOnSpawn = false,
        ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
        DisplayOrder = 998
    })

    local IntroFrame = CreateObject("Frame", {
        Name = "IntroFrame",
        Parent = IntroGui,
        BackgroundColor3 = Config.intro.backgroundColor,
        BorderSizePixel = 0,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1
    })

    -- Add blur effect if enabled
    if Config.intro.enableBlur then
        local blur = CreateObject("BlurEffect", {
            Name = "IntroBlur",
            Parent = game:GetService("Lighting"),
            Size = 24
        })
        SmoothTween(blur, Config.intro.duration / 2, {Size = 24})
        task.spawn(function()
            task.wait(Config.intro.duration)
            SmoothTween(blur, Config.intro.duration / 2, {Size = 0})
            task.wait(Config.intro.duration / 2)
            blur:Destroy()
        end)
    end

    local IntroIcon = CreateObject("ImageLabel", {
        Name = "IntroIcon",
        Parent = IntroFrame,
        BackgroundTransparency = 1,
        Image = Config.intro.iconId,
        Position = UDim2.new(0.5, 0, 0.35, 0),
        Size = Config.intro.iconSize,
        AnchorPoint = Vector2.new(0.5, 0.5),
        ImageTransparency = 1
    })

    local IntroText = CreateObject("TextLabel", {
        Name = "IntroText",
        Parent = IntroFrame,
        BackgroundTransparency = 1,
        Text = Config.intro.text,
        Position = UDim2.new(0.5, 0, 0.65, 0),
        Size = UDim2.new(0, 400, 0, 50),
        Font = Config.intro.font,
        TextColor3 = Config.intro.textColor,
        TextSize = Config.intro.textSize,
        TextXAlignment = Enum.TextXAlignment.Center,
        AnchorPoint = Vector2.new(0.5, 0.5),
        TextTransparency = 1
    })
    CreateObject("UIStroke", {Color = Config.intro.textColor, Thickness = 1, Transparency = 0.5, Parent = IntroText})

    -- Play intro sound
    PlaySound({Id = Config.intro.soundId})

    -- Fade in
    SmoothTween(IntroFrame, Config.intro.duration / 2, {BackgroundTransparency = 0})
    SmoothTween(IntroIcon, Config.intro.duration / 2, {ImageTransparency = 0})
    SmoothTween(IntroText, Config.intro.duration / 2, {TextTransparency = 0})

    -- Wait and fade out
    task.wait(Config.intro.duration / 2)
    SmoothTween(IntroFrame, Config.intro.duration / 2, {BackgroundTransparency = 1})
    SmoothTween(IntroIcon, Config.intro.duration / 2, {ImageTransparency = 1})
    SmoothTween(IntroText, Config.intro.duration / 2, {TextTransparency = 1})

    task.wait(Config.intro.duration / 2)
    IntroGui:Destroy()
end

-- Show intro before main GUI
ShowIntro()

local ScreenGui = CreateObject("ScreenGui", {
    Name = Config.title, Parent = CoreGui, ResetOnSpawn = false, ZIndexBehavior = Enum.ZIndexBehavior.Sibling, DisplayOrder = 999
})

if not ScreenGui then
    warn("Failed to create ScreenGui, check CoreGui access")
    return
end

local MainFrame = CreateObject("Frame", {
    Name = "MainFrame", Parent = ScreenGui, BackgroundColor3 = KeySystemData.Colors.Background, BorderSizePixel = 0,
    Position = UDim2.new(0.5, 0, 0.5, 0), AnchorPoint = Vector2.new(0.5, 0.5), Size = UDim2.new(0, 350, 0, 250), ClipsDescendants = true
})
CreateObject("UICorner", {CornerRadius = UDim.new(0, 12), Parent = MainFrame})
local gradient = CreateObject("UIGradient", {Color = ColorSequence.new(KeySystemData.Colors.BackgroundGradientFrom, KeySystemData.Colors.BackgroundGradientTo), Rotation = 90, Parent = MainFrame})
local mainStroke = CreateObject("UIStroke", {Parent = MainFrame, Color = KeySystemData.Colors.InputFieldBorder, Thickness = 1.5, Transparency = 0.5})

local TitleBar = CreateObject("Frame", {
    Name = "TitleBar", Parent = MainFrame, BackgroundColor3 = Color3.fromRGB(0, 0, 0), BackgroundTransparency = 0.8,
    Size = UDim2.new(1, 0, 0, 30), BorderSizePixel = 0, Position = UDim2.new(0, 0, 0, 0)
})
CreateObject("UICorner", {CornerRadius = UDim.new(0, 12), Parent = TitleBar})
CreateObject("UIStroke", {Color = KeySystemData.Colors.Title, Thickness = 1, Transparency = 0.7, Parent = TitleBar})

local Title = CreateObject("TextLabel", {
    Name = "Title", Parent = TitleBar, BackgroundTransparency = 1, Text = Config.title,
    Position = UDim2.new(0.5, 0, 0.5, 0), Size = UDim2.new(0, 200, 0, 20), Font = Enum.Font.SciFi,
    TextColor3 = KeySystemData.Colors.Title, TextSize = 16, TextXAlignment = Enum.TextXAlignment.Center, AnchorPoint = Vector2.new(0.5, 0.5)
})
CreateObject("UIStroke", {Color = KeySystemData.Colors.Title, Thickness = 0.5, Transparency = 0.4, Parent = Title})

local KeyInput = CreateObject("TextBox", {
    Name = "KeyInput", Parent = MainFrame, BackgroundColor3 = KeySystemData.Colors.InputField, Text = "",
    PlaceholderText = "Enter your key here...", Position = UDim2.new(0.5, 0, 0.32, 0), Size = UDim2.new(0, 280, 0, 35),
    Font = Enum.Font.SciFi, TextSize = 14, TextColor3 = Color3.fromRGB(220, 220, 255), PlaceholderColor3 = Color3.fromRGB(100, 100, 150),
    TextXAlignment = Enum.TextXAlignment.Left, AnchorPoint = Vector2.new(0.5, 0), ClipsDescendants = true, ClearTextOnFocus = false
})
CreateObject("UICorner", {CornerRadius = UDim.new(0, 8), Parent = KeyInput})
local inputStroke = CreateObject("UIStroke", {Parent = KeyInput, Color = KeySystemData.Colors.InputFieldBorder, Thickness = 1.5, Transparency = 0.6})
CreateObject("UIPadding", {Parent = KeyInput, PaddingLeft = UDim.new(0, 10)})

local SubmitButton = CreateObject("TextButton", {
    Name = "ValidateButton", Parent = MainFrame, BackgroundColor3 = KeySystemData.Colors.Button, BorderSizePixel = 0,
    Position = UDim2.new(0.3, 0, 0.55, 0), Size = UDim2.new(0, 110, 0, 32), Text = "Verify Key",
    Font = Enum.Font.SciFi, TextSize = 14, TextColor3 = KeySystemData.Colors.Title, AutoButtonColor = false, AnchorPoint = Vector2.new(0.5, 0)
})
CreateObject("UICorner", {CornerRadius = UDim.new(0, 8), Parent = SubmitButton})
local submitStroke = CreateObject("UIStroke", {Parent = SubmitButton, Color = KeySystemData.Colors.InputFieldBorder, Thickness = 1.5, Transparency = 0.6})

local GetKeyButton = CreateObject("TextButton", {
    Name = "GetKeyButton", Parent = MainFrame, BackgroundColor3 = KeySystemData.Colors.Button, BorderSizePixel = 0,
    Position = UDim2.new(0.7, 0, 0.55, 0), Size = UDim2.new(0, 110, 0, 32), Text = "Get Key",
    Font = Enum.Font.SciFi, TextSize = 14, TextColor3 = KeySystemData.Colors.Title, AutoButtonColor = false, AnchorPoint = Vector2.new(0.5, 0)
})
CreateObject("UICorner", {CornerRadius = UDim.new(0, 8), Parent = GetKeyButton})
local getKeyStroke = CreateObject("UIStroke", {Parent = GetKeyButton, Color = KeySystemData.Colors.InputFieldBorder, Thickness = 1.5, Transparency = 0.6})

local DiscordButton = CreateObject("TextButton", {
    Name = "DiscordButton", Parent = MainFrame, BackgroundColor3 = KeySystemData.Colors.Discord, BorderSizePixel = 0,
    Position = UDim2.new(0.5, 0, 0.75, 0), Size = UDim2.new(0, 220, 0, 32), Text = "Join Discord",
    Font = Enum.Font.SciFi, TextSize = 14, TextColor3 = Color3.fromRGB(255, 255, 255), AutoButtonColor = false, AnchorPoint = Vector2.new(0.5, 0)
})
CreateObject("UICorner", {CornerRadius = UDim.new(0, 8), Parent = DiscordButton})
local discordStroke = CreateObject("UIStroke", {Parent = DiscordButton, Color = KeySystemData.Colors.Discord, Thickness = 1.5, Transparency = 0.6})

local StatusLabel = CreateObject("TextLabel", {
    Name = "StatusLabel", Parent = MainFrame, BackgroundTransparency = 1, Position = UDim2.new(0.5, 0, 0.9, 0),
    Size = UDim2.new(0, 280, 0, 20), Font = Enum.Font.SciFi, Text = "", TextColor3 = KeySystemData.Colors.Error,
    TextSize = 12, TextXAlignment = Enum.TextXAlignment.Center, AnchorPoint = Vector2.new(0.5, 0), TextTransparency = 1
})
CreateObject("UIStroke", {Parent = StatusLabel, Color = KeySystemData.Colors.Error, Thickness = 1, Transparency = 0.5})

local function CreateTrail(frame)
    local success, trail = pcall(function()
        local trail = frame:Clone()
        trail.Name = "Trail"
        trail.Parent = ScreenGui
        trail.ZIndex = frame.ZIndex - 1
        trail:ClearAllChildren()
        trail.BackgroundColor3 = KeySystemData.Colors.InputFieldBorder
        trail.BackgroundTransparency = 0.7
        trail.Size = frame.Size
        trail.Position = frame.Position
        trail.AnchorPoint = frame.AnchorPoint
        CreateObject("UIGradient", {Color = ColorSequence.new(KeySystemData.Colors.InputFieldBorder, Color3.fromRGB(0, 0, 0)), Rotation = 90, Parent = trail})
        SmoothTween(trail, 0.5, {BackgroundTransparency = 1, Size = frame.Size * 1.1}, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)
        task.delay(0.5, function() trail:Destroy() end)
        return trail
    end)
    if not success then warn("Trail creation failed: " .. tostring(trail)) end
end

local function AddGlow(stroke)
    SmoothTween(stroke, 0.2, {Transparency = 0.3, Thickness = 2})
end

local function RemoveGlow(stroke)
    SmoothTween(stroke, 0.2, {Transparency = 0.6, Thickness = 1.5})
end

local function AddButtonAnimations(button, stroke)
    button.MouseEnter:Connect(function()
        AddGlow(stroke)
        SmoothTween(button, 0.2, {BackgroundColor3 = KeySystemData.Colors.ButtonHover, Size = button.Size + UDim2.new(0, 5, 0, 2)})
    end)
    button.MouseLeave:Connect(function()
        RemoveGlow(stroke)
        SmoothTween(button, 0.2, {BackgroundColor3 = button.Name == "DiscordButton" and KeySystemData.Colors.Discord or KeySystemData.Colors.Button, Size = button.Size - UDim2.new(0, 5, 0, 2)})
    end)
    button.MouseButton1Down:Connect(function() SmoothTween(button, 0.1, {Size = button.Size - UDim2.new(0, 5, 0, 2)}) end)
    button.MouseButton1Up:Connect(function() SmoothTween(button, 0.1, {Size = button.Size + UDim2.new(0, 5, 0, 2)}) end)
end

AddButtonAnimations(SubmitButton, submitStroke)
AddButtonAnimations(GetKeyButton, getKeyStroke)
AddButtonAnimations(DiscordButton, discordStroke)

KeyInput.Focused:Connect(function() AddGlow(inputStroke) end)
KeyInput.FocusLost:Connect(function() RemoveGlow(inputStroke) end)

local function ShowStatusMessage(text, color)
    StatusLabel.Text = text
    StatusLabel.TextColor3 = color
    StatusLabel.TextTransparency = 0
    SmoothTween(StatusLabel, 0.3, {TextTransparency = 0})
    task.spawn(function()
        task.wait(3)
        if StatusLabel.Text == text then SmoothTween(StatusLabel, 0.5, {TextTransparency = 1}) end
    end)
end

local function openGetKey()
    local JunkieKeySystem = loadstring(game:HttpGet("https://junkie-development.de/sdk/JunkieKeySystem.lua"))()
    local API_KEY = Config.api
    local PROVIDER = Config.provider
    local SERVICE = Config.service
    local link = JunkieKeySystem.getLink(API_KEY, PROVIDER, SERVICE)
    if link then
        if setclipboard then
            setclipboard(link)
            ShowStatusMessage("Verification link copied!", KeySystemData.Colors.Success)
            PlaySound(SoundAssets.Success)
        else
            ShowStatusMessage("Link: " .. link, KeySystemData.Colors.Success)
            PlaySound(SoundAssets.Success)
        end
    else
        ShowStatusMessage("Failed to generate link", KeySystemData.Colors.Error)
        PlaySound(SoundAssets.Error)
    end
end

local function validateKey()
    local userKey = KeyInput.Text:gsub("%s+", "")
    if not userKey or userKey == "" then
        ShowStatusMessage("Please enter a key.", KeySystemData.Colors.Error)
        PlaySound(SoundAssets.AccessDenied)
        return
    end
    ShowStatusMessage("Validating key...", Color3.fromRGB(255, 165, 0))
    local JunkieKeySystem = loadstring(game:HttpGet("https://junkie-development.de/sdk/JunkieKeySystem.lua"))()
    local API_KEY = Config.api
    local SERVICE = Config.service
    local isValid = JunkieKeySystem.verifyKey(API_KEY, userKey, SERVICE)
    if isValid then
        ShowStatusMessage("Key valid! Loading Script...", KeySystemData.Colors.Success)
        PlaySound(SoundAssets.Success)
        if writefile then pcall(function() writefile(KeySystemData.FileName, userKey) end) end
        SmoothTween(MainFrame, 0.5, {Position = UDim2.new(0.5, 0, -0.5, 0), BackgroundTransparency = 1}, Enum.EasingStyle.Quad, Enum.EasingDirection.In)
        task.wait(0.5)
        ScreenGui:Destroy()
        main()
    else
        ShowStatusMessage("Invalid key. Try again!", KeySystemData.Colors.Error)
        PlaySound(SoundAssets.AccessDenied)
    end
end

SubmitButton.MouseButton1Click:Connect(function()
    PlaySound(SoundAssets.ButtonClick)
    validateKey()
end)

GetKeyButton.MouseButton1Click:Connect(function()
    PlaySound(SoundAssets.ButtonClick)
    openGetKey()
end)

local dragging, dragInput, dragStart, startPos
local function onInputChanged(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        CreateTrail(MainFrame)
    end
end

TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end)
    end
end)

TitleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end
end)

UserInputService.InputChanged:Connect(onInputChanged)

DiscordButton.MouseButton1Click:Connect(function()
    PlaySound(SoundAssets.ButtonClick)
    local discordUrl = "https://discord.gg/" .. KeySystemData.DiscordInvite
    if setclipboard then
        setclipboard(discordUrl)
        ShowStatusMessage("Copied Discord invite!", KeySystemData.Colors.Discord)
        PlaySound(SoundAssets.SuccessDiscord)
    else
        ShowStatusMessage("Join: " .. discordUrl, KeySystemData.Colors.Discord)
        PlaySound(SoundAssets.SuccessDiscord)
    end
end)

KeyInput.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        PlaySound(SoundAssets.ButtonClick)
        validateKey()
    end
end)

if isfile and readfile then
    local success, savedKey = pcall(function()
        if isfile(KeySystemData.FileName) then return readfile(KeySystemData.FileName) end
        return nil
    end)
    if success and savedKey and savedKey ~= "" then
        KeyInput.Text = savedKey
        task.spawn(validateKey)
    end
end

MainFrame.Position = UDim2.new(0.5, 0, 0.5, 100)
MainFrame.Size = UDim2.new(0, 0, 0, 0)
MainFrame.BackgroundTransparency = 1
CreateTrail(MainFrame)
SmoothTween(MainFrame, 0.7, {Size = UDim2.new(0, 350, 0, 250), Position = UDim2.new(0.5, 0, 0.5, 0), BackgroundTransparency = 0}, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut)
SmoothTween(mainStroke, 0.7, {Transparency = 0.2}, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
PlaySound(SoundAssets.UIOpen)Size = button.Size - UDim2.new(0, 5, 0, 2)}) end)
    button.MouseButton1Up:Connect(function() SmoothTween(button, 0.1, {Size = button.Size + UDim2.new(0, 5, 0, 2)}) end)
end

AddButtonAnimations(SubmitButton, submitStroke)
AddButtonAnimations(GetKeyButton, getKeyStroke)
AddButtonAnimations(DiscordButton, discordStroke)

KeyInput.Focused:Connect(function() AddGlow(inputStroke) end)
KeyInput.FocusLost:Connect(function() RemoveGlow(inputStroke) end)

local function ShowStatusMessage(text, color)
    StatusLabel.Text = text
    StatusLabel.TextColor3 = color
    StatusLabel.TextTransparency = 0
    SmoothTween(StatusLabel, 0.3, {TextTransparency = 0})
    task.spawn(function()
        task.wait(3)
        if StatusLabel.Text == text then SmoothTween(StatusLabel, 0.5, {TextTransparency = 1}) end
    end)
end

local function openGetKey()
    local JunkieKeySystem = loadstring(game:HttpGet("https://junkie-development.de/sdk/JunkieKeySystem.lua"))()
    local API_KEY = Config.api
    local PROVIDER = Config.provider
    local SERVICE = Config.service
    local link = JunkieKeySystem.getLink(API_KEY, PROVIDER, SERVICE)
    if link then
        if setclipboard then
            setclipboard(link)
            ShowStatusMessage("Verification link copied!", KeySystemData.Colors.Success)
            PlaySound(SoundAssets.Success)
        else
            ShowStatusMessage("Link: " .. link, KeySystemData.Colors.Success)
            PlaySound(SoundAssets.Success)
        end
    else
        ShowStatusMessage("Failed to generate link", KeySystemData.Colors.Error)
        PlaySound(SoundAssets.Error)
    end
end

local function validateKey()
    local userKey = KeyInput.Text:gsub("%s+", "")
    if not userKey or userKey == "" then
        ShowStatusMessage("Please enter a key.", KeySystemData.Colors.Error)
        PlaySound(SoundAssets.AccessDenied)
        return
    end
    ShowStatusMessage("Validating key...", Color3.fromRGB(255, 165, 0))
    local JunkieKeySystem = loadstring(game:HttpGet("https://junkie-development.de/sdk/JunkieKeySystem.lua"))()
    local API_KEY = Config.api
    local SERVICE = Config.service
    local isValid = JunkieKeySystem.verifyKey(API_KEY, userKey, SERVICE)
    if isValid then
        ShowStatusMessage("Key valid! Loading Script...", KeySystemData.Colors.Success)
        PlaySound(SoundAssets.Success)
        if writefile then pcall(function() writefile(KeySystemData.FileName, userKey) end) end
        SmoothTween(MainFrame, 0.5, {Position = UDim2.new(0.5, 0, -0.5, 0), BackgroundTransparency = 1}, Enum.EasingStyle.Quad, Enum.EasingDirection.In)
        task.wait(0.5)
        ScreenGui:Destroy()
        main()
    else
        ShowStatusMessage("Invalid key. Try again!", KeySystemData.Colors.Error)
        PlaySound(SoundAssets.AccessDenied)
    end
end

SubmitButton.MouseButton1Click:Connect(function()
    PlaySound(SoundAssets.ButtonClick)
    validateKey()
end)

GetKeyButton.MouseButton1Click:Connect(function()
    PlaySound(SoundAssets.ButtonClick)
    openGetKey()
end)

local dragging, dragInput, dragStart, startPos
local function onInputChanged(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        CreateTrail(MainFrame)
    end
end

TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end)
    end
end)

TitleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end
end)

UserInputService.InputChanged:Connect(onInputChanged)

DiscordButton.MouseButton1Click:Connect(function()
    PlaySound(SoundAssets.ButtonClick)
    local discordUrl = "https://discord.gg/" .. KeySystemData.DiscordInvite
    if setclipboard then
        setclipboard(discordUrl)
        ShowStatusMessage("Copied Discord invite!", KeySystemData.Colors.Discord)
        PlaySound(SoundAssets.SuccessDiscord)
    else
        ShowStatusMessage("Join: " .. discordUrl, KeySystemData.Colors.Discord)
        PlaySound(SoundAssets.SuccessDiscord)
    end
end)

KeyInput.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        PlaySound(SoundAssets.ButtonClick)
        validateKey()
    end
end)

if isfile and readfile then
    local success, savedKey = pcall(function()
        if isfile(KeySystemData.FileName) then return readfile(KeySystemData.FileName) end
        return nil
    end)
    if success and savedKey and savedKey ~= "" then
        KeyInput.Text = savedKey
        task.spawn(validateKey)
    end
end

MainFrame.Position = UDim2.new(0.5, 0, 0.5, 100)
MainFrame.Size = UDim2.new(0, 0, 0, 0)
MainFrame.BackgroundTransparency = 1
CreateTrail(MainFrame)
SmoothTween(MainFrame, 0.7, {Size = UDim2.new(0, 350, 0, 250), Position = UDim2.new(0.5, 0, 0.5, 0), BackgroundTransparency = 0}, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut)
SmoothTween(mainStroke, 0.7, {Transparency = 0.2}, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
PlaySound(SoundAssets.UIOpen)
